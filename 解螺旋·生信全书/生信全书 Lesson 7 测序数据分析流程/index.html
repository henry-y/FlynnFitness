<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="x5-fullscreen" content="true">
<meta name="full-screen" content="yes">
<meta name="theme-color" content="#317EFB" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=0" name="viewport">
<meta name="description" content="TIP这些是本篇文章的标签，来发现更多感兴趣的内容吧科研解螺旋生信全书测序  原机下载数据 数据分析从获得测序数据开始，一般我们拿到的二代测序下机数据为FASTQ格式，储存了测序序列，也就是序列信息（reads）以及对应的质量信息等，习惯上称之为raw data 复习Lesson 5中的内容 FASTQ文件如图所示，每4行分为一个单元 第一行为序列名称，以“@”开头，一般是测序仪产生的，第三行也是">
<meta property="og:type" content="article">
<meta property="og:title" content="生信全书 Lesson 7 测序数据分析流程">
<meta property="og:url" content="http://example.com/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6%20Lesson%207%20%E6%B5%8B%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B/index.html">
<meta property="og:site_name" content="Flynn&#39;s Blog">
<meta property="og:description" content="TIP这些是本篇文章的标签，来发现更多感兴趣的内容吧科研解螺旋生信全书测序  原机下载数据 数据分析从获得测序数据开始，一般我们拿到的二代测序下机数据为FASTQ格式，储存了测序序列，也就是序列信息（reads）以及对应的质量信息等，习惯上称之为raw data 复习Lesson 5中的内容 FASTQ文件如图所示，每4行分为一个单元 第一行为序列名称，以“@”开头，一般是测序仪产生的，第三行也是">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/404.jpg">
<meta property="og:image" content="http://example.com/img/404.jpg">
<meta property="og:image" content="http://example.com/img/404.jpg">
<meta property="og:image" content="http://example.com/img/404.jpg">
<meta property="og:image" content="http://example.com/img/404.jpg">
<meta property="og:image" content="http://example.com/img/404.jpg">
<meta property="og:image" content="http://example.com/img/404.jpg">
<meta property="og:image" content="http://example.com/img/404.jpg">
<meta property="og:image" content="http://example.com/img/404.jpg">
<meta property="og:image" content="http://example.com/img/404.jpg">
<meta property="og:image" content="http://example.com/img/404.jpg">
<meta property="article:published_time" content="2024-10-24T05:07:26.970Z">
<meta property="article:modified_time" content="2024-10-24T05:07:26.970Z">
<meta property="article:author" content="Flynn">
<meta property="article:tag" content="科研">
<meta property="article:tag" content="解螺旋">
<meta property="article:tag" content="生信全书">
<meta property="article:tag" content="测序">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/404.jpg">


<title >生信全书 Lesson 7 测序数据分析流程</title>

<!-- Favicon -->

    <link href='/img/16.svg?v=2.1.13' rel='icon' type='image/png' sizes='16x16' ></link>


    <link href='/img/32.svg?v=2.1.13' rel='icon' type='image/png' sizes='32x32' ></link>




<!-- Plugin -->




    
<link rel="stylesheet" href="/css/plugins/bootstrap.row.css">

    
<link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.css">

    
    




<!-- Icon -->

    
<link rel="stylesheet" href="/css/plugins/font-awesome.min.css">




<!-- Variable -->
<script>window.ASYNC_CONFIG = {"hostname":"example.com","author":"Flynn","root":"/","typed_text":null,"theme_version":"2.1.13","theme":{"switch":true,"default":"auto"},"favicon":{"logo":"img/200.svg","icon16":"img/16.svg","icon32":"img/32.svg","appleTouchIcon":null,"webmanifest":null,"visibilitychange":true,"hidden":"/failure.ico","showText":"(/≧▽≦/)Hey! Good again!","hideText":"(●—●)Oh, crash!","apple_touch_icon":"img/200.svg"},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms","author":"Post author: ","copyright_link":"Post link: ","copyright_license_title":"Copyright Notice: ","copyright_license_content":"All articles in this blog are licensed under undefined unless otherwise stated.","copy_success":"Copied","copy_failure":"Copy failed","open_read_mode":"Enter reading mode","exit_read_mode":"Exit reading mode","notice_outdate_message":"It has been undefined days since the last update, the content of the article may be outdated.","sticky":"TOP","just":"Just","min":"minutes ago","hour":"hours ago","day":"days ago","month":"months ago"},"swup":false,"plugin":{"flickr_justified_gallery":"https://unpkg.com/flickr-justified-gallery@latest/dist/fjGallery.min.js"},"icons":{"sun":"far fa-sun","moon":"far fa-moon","play":"fas fa-play","email":"far fa-envelope","next":"fas fa-arrow-right","calendar":"far fa-calendar-alt","clock":"far fa-clock","user":"far fa-user","back_top":"fas fa-arrow-up","close":"fas fa-times","search":"fas fa-search","reward":"fas fa-hand-holding-usd","user_tag":"fas fa-user-alt","toc_tag":"fas fa-th-list","read":"fas fa-book-reader","arrows":"fas fa-arrows-alt-h","double_arrows":"fas fa-angle-double-down","copy":"fas fa-copy"},"icontype":"font","highlight":{"plugin":"highlighjs","theme":true,"copy":true,"lang":true,"title":"default","height_limit":false},"toc":{"post_title":false},"live_time":{"start_time":"2024-02-09 17:00","prefix":"The blog has been lovely to run undefined day"},"danmu":{"enable":false,"el":".trm-banner"},"covers":["/img/banner.jpg","/img/avatar.jpg"],"search":{"enable":true,"type":"local","href":"https://www.google.com/search?q=site:","domain":null,"result_placeholder":"testing..","path":"search.xml"}};</script>
<script id="async-page-config">window.PAGE_CONFIG = {"isPost":true,"isHome":false,"postUpdate":"2024-10-24 13:07:26"};</script>

<!-- Theme mode css -->
<link data-swup-theme rel="stylesheet" href="/css/index.css?v=2.1.13" id="trm-switch-style">
<script>
    let defaultMode = ASYNC_CONFIG.theme.default !=='auto' ?  ASYNC_CONFIG.theme.default : (window.matchMedia("(prefers-color-scheme: light)").matches ? 'style-light' : 'style-dark')
    let catchMode = localStorage.getItem('theme-mode') || defaultMode;
    let type = catchMode === 'style-dark' ? 'add' : 'remove';
    document.documentElement.classList[type]('dark')
</script>

<!-- CDN -->


    
    



<!-- Site Analytics -->
 
<meta name="generator" content="Hexo 7.1.1"></head>

<body>

  <!-- app wrapper -->
  <div class="trm-app-frame">

    <!-- page preloader -->
    <div class="trm-preloader">
    <div class="trm-holder">
        <div class="preloader">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div>
    <!-- page preloader end -->

    <!-- change mode preloader -->
    <div class="trm-mode-swich-animation-frame">
    <div class="trm-mode-swich-animation">
        <i class="i-sun"><i class="iconfont far fa-sun"></i></i>
        <div class="trm-horizon"></div>
        <i class="i-moon"><i class="iconfont far fa-moon"></i></i>
    </div>
</div>
    <!-- change mode preloader end -->

      <!-- scroll container -->
      <div id="trm-dynamic-content" class="trm-swup-animation">
        <div id="trm-scroll-container" class="trm-scroll-container" style="opacity: 0">
            <!-- top bar -->
            <header class="trm-top-bar">
	<div class="container">
		<div class="trm-left-side">
			<!-- logo -->
<a href="/" class="trm-logo-frame trm-anima-link">
    
        <img alt="logo" src="/img/200.svg">
    
    
        <div class="trm-logo-text">
            Flynn<span>姜</span>
        </div>
    
</a>
<!-- logo end -->
		</div>
		<div class="trm-right-side">
			<!-- menu -->
<div class="trm-menu">
    <nav>
        <ul>
            
            <li class="menu-item-has-children ">
                <a  href="/" target="">
                    主页
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a data-no-swup href="/archives/" target="">
                    归档
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/categories/" target="">
                    分类
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/tags/" target="">
                    标签
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/about/" target="">
                    关于我
                </a>
                
            </li>
            
        </ul>
    </nav>
</div>
<!-- menu end -->
			
    <!-- mode switcher place -->
    <div class="trm-mode-switcher-place">
        <div class="trm-mode-switcher">
            <i class="iconfont far fa-sun"></i>
            <input class="tgl tgl-light" id="trm-swich" type="checkbox">
            <label class="trm-swich" for="trm-swich"></label>
            <i class="iconfont far fa-moon"></i>
        </div>
    </div>
    <!-- mode switcher place end -->

			
    
    <div id="trm-search-btn" class="trm-search-btn">
        <i class="iconfont fas fa-search"></i>
    </div>
     

		</div>
		<div class="trm-menu-btn">
			<span></span>
		</div>
	</div>
</header>
            <!-- top bar end -->

            <!-- body -->
            
<div class="trm-content-start">
    <!-- banner -->
    <div class="trm-banner">
    
    <!-- banner cover -->
    <img style="object-position:top;object-fit:cover;" alt="banner" class="trm-banner-cover" src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/cover.jpg">
    <!-- banner cover end -->
    

    <!-- banner content -->
    <div class="trm-banner-content trm-overlay">
        <div class="container">
            <div class="row">
                
                <div class="col-lg-4"></div>
                
                <div class="col-lg-8">

                    <!-- banner title -->
                    <div class="trm-banner-text ">
                        <div class="trm-label trm-mb-20">
                            
                        </div>
                        <h1 class="trm-mb-30 trm-hsmb-font">
                            生信全书 Lesson 7 测序数据分析流程
                        </h1>

                        
                            <ul class="trm-breadcrumbs trm-label">
                                <li>
                                    <a href="/" class="trm-anima-link">Home</a>
                                </li>
                                <li>
                                    <span>
                                        解螺旋·生信全书
                                    </span>
                                </li>
                            </ul>
                        
                    </div>
                    <!-- banner title end -->

                    <!-- scroll hint -->
                    <span id="scroll-triger" class="trm-scroll-hint-frame">
                        <div class="trm-scroll-hint"></div>
                        <span class="trm-label">Scroll down</span>
                    </span>
                    <!-- scroll hint end -->

                </div>
            </div>
        </div>
    </div>
    <!-- banner content end -->
</div>
    <!-- banner end -->
    <div class="container">
        <div class="row">
            
                <div class="trm-page-sidebar col-lg-4 hidden-sm">
                    <!-- main card -->
                    <div class="trm-main-card-frame trm-sidebar">
    <div class="trm-main-card"> 
        <!-- card header -->
<div class="trm-mc-header">
    <div class="trm-avatar-frame trm-mb-20">
        <img alt="Avatar" class="trm-avatar" src="/img/flynn.jpg">
    </div>
    <h5 class="trm-name trm-mb-15">
        Flynn
    </h5>
    
</div>
<!-- card header end -->
        <!-- sidebar social -->

<!-- sidebar social end -->
        <!-- info -->
<div class="trm-divider trm-mb-40 trm-mt-40"></div>
<ul class="trm-table trm-mb-20">
    
        <li>
            <div class="trm-label">
                地址:
            </div>
            <div class="trm-label trm-label-light">
                广州/深圳
            </div>
        </li>
    
        <li>
            <div class="trm-label">
                年龄:
            </div>
            <div class="trm-label trm-label-light">
                24
            </div>
        </li>
    
</ul>
<!-- info end -->

        
    <div class="trm-divider trm-mb-40 trm-mt-40"></div>
    <!-- action button -->
    <div class="text-center">
        <a href="mailto:240443192@qq.com" class="trm-btn">
            Contact Me
            <i class="iconfont far fa-envelope"></i>
        </a>
    </div>
    <!-- action button end -->

    </div>
</div>
                    <!-- main card end -->
                </div>
            
            <div class="trm-page-content col-lg-8">
                <div id="trm-content" class="trm-content">
                    <div class="trm-post-info row hidden-sm">
    <div class="col-sm-4">
        <div class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-calendar-alt trm-icon"></i><br>
            10/24
        </div>
    </div>
    <div class="col-sm-4">
        <div class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-clock trm-icon"></i><br>
            13:07
        </div>
    </div>
    <div class="col-sm-4">
        <div id="post-author" class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-user trm-icon"></i><br>
            Flynn
        </div>
    </div>
</div>
<div class="trm-card ">
    <article id="article-container" class="trm-publication">
    <div class="trm-note tip"><div class="trm-note-title">TIP</div><p>这些是本篇文章的标签，来发现更多感兴趣的内容吧<br><a target="_blank" rel="noopener" href="http://blog.flynn2059.top/tags/%E7%A7%91%E7%A0%94/">科研</a><br><a target="_blank" rel="noopener" href="http://blog.flynn2059.top/tags/%E8%A7%A3%E8%9E%BA%E6%97%8B/">解螺旋</a><br><a target="_blank" rel="noopener" href="http://blog.flynn2059.top/tags/%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/">生信全书</a><br><a target="_blank" rel="noopener" href="http://blog.flynn2059.top/tags/%E6%B5%8B%E5%BA%8F/">测序</a></p>
</div>
<h1 id="原机下载数据"><a href="#原机下载数据" class="headerlink" title="原机下载数据"></a>原机下载数据</h1><ul>
<li>数据分析从获得测序数据开始，一般我们拿到的二代测序下机数据为FASTQ格式，储存了测序序列，也就是序列信息（reads）以及对应的质量信息等，习惯上称之为raw data</li>
<li><a target="_blank" rel="noopener" href="http://blog.flynn2059.top/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6%20Lesson%205%20%E6%B5%8B%E5%BA%8F%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">复习Lesson 5中的内容</a></li>
<li>FASTQ文件如图所示，每4行分为一个单元<br><img src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E6%88%AA%E5%B1%8F2024-04-20%2023.34.34.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><ul>
<li>第一行为序列名称，以“@”开头，一般是测序仪产生的，第三行也是序列名称，以“+”开头，为了节省储存空间，“+”之后的内容就不显示了</li>
<li>第二行是序列的碱基，也就是ATGC</li>
<li>第四行是测序的质量，每个字符都与第二行的同一个位置的碱基一一对应</li>
</ul>
</li>
<li>如果是单端测序，对于每个样本我们只会得到一个这样的FASTQ文件；如果是双端测序，对于每个样本我们会得到2个FASTQ文件，一个是R1的，一个是R2的</li>
</ul>
<h2 id="单端测序和双端测序的比较"><a href="#单端测序和双端测序的比较" class="headerlink" title="单端测序和双端测序的比较"></a>单端测序和双端测序的比较</h2><p><img src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/Pasted%20image%2020240420234818.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br><img src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E6%88%AA%E5%B1%8F2024-04-20%2023.49.20.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<blockquote>
<p>Paired-end sequencing facilitates detection of genomic rearrangements and repetitive sequence elements, as well as gene fusions and novel transcripts.</p>
</blockquote>
<blockquote>
<p>In addition to producing twice the number of reads for the same time and effort in library preparation, sequences aligned as read pairs enable more accurate read alignment and the ability to detect insertion-deletion (indel) variants, which is more difficult with single-read data.</p>
</blockquote>
<h1 id="测序质量评估和质控处理"><a href="#测序质量评估和质控处理" class="headerlink" title="测序质量评估和质控处理"></a>测序质量评估和质控处理</h1><h2 id="质量评估：FastQC"><a href="#质量评估：FastQC" class="headerlink" title="质量评估：FastQC"></a>质量评估：FastQC</h2><ul>
<li>FastQC官网：<a target="_blank" rel="noopener" href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/">http://www.bioinformatics.babraham.ac.uk/projects/fastqc/</a></li>
<li>这个软件运行结束后会生成两个文件：一个是 html 网页文件，一个是zip压缩文件。如果我们使用浏览器打开 html文件，它显示的内容如下图所示<br><img src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E6%88%AA%E5%B1%8F2024-04-20%2023.59.53.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></li>
<li>展示的内容<ul>
<li>基本信息</li>
<li>序列整体测序质量统计</li>
<li>每条序列的测序质量统计和碱基分布</li>
<li>序列平均 GC含量分布图</li>
<li>N含量统计</li>
<li>序列测序长度统计</li>
<li>重复序列统计</li>
<li>等等</li>
</ul>
</li>
<li>一个合格原始数据，它的质控结果应该全是绿色的</li>
</ul>
<h3 id="碱基质量评估的结果"><a href="#碱基质量评估的结果" class="headerlink" title="碱基质量评估的结果"></a>碱基质量评估的结果</h3><p><img src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E6%88%AA%E5%B1%8F2024-04-21%2000.03.48.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<ul>
<li>横轴为read的长度，纵轴为Phred数值，也就是质量得分，是通过概率模型得到的</li>
<li>Phred&#x3D;30时，碱基正确识别率为99%，这就是我们常提到的Q30</li>
<li>图片的判读<ul>
<li>黄色box：25-75%区间的质量分布</li>
<li>黑色的error bar“10-90%区间的质量分布</li>
<li>红线：中位数</li>
<li>蓝色：平均值</li>
</ul>
</li>
<li><strong>如何根据一份数据的这张图对数据进行评估：我们希望所有位置的10%分位数的Phred值&gt;20，即最下面的黑色横线要在黄色区域以内，才能认为质量合格</strong></li>
</ul>
<h2 id="质控处理"><a href="#质控处理" class="headerlink" title="质控处理"></a>质控处理</h2><ul>
<li>质控常用软件：<a target="_blank" rel="noopener" href="http://www.usadellab.org/cms/?page=trimmomatic">Trimmomatic</a>、trim-galore、cutadapt</li>
</ul>
<h3 id="质控处理的目的"><a href="#质控处理的目的" class="headerlink" title="质控处理的目的"></a>质控处理的目的</h3><ul>
<li>去除低质量碱基</li>
<li>去除低质量reads</li>
<li>去除接头序列</li>
<li>去除头部和尾部的：低质量的，以及过多的reads</li>
<li>丢掉小于一定长度的reads</li>
<li>经过质控处理，我们得到的仍然是FASTQ文件，我们把这样经过质控处理的文件称为clean data</li>
</ul>
<h1 id="基因组比对"><a href="#基因组比对" class="headerlink" title="基因组比对"></a>基因组比对</h1><ul>
<li>比对常用软件：<a target="_blank" rel="noopener" href="https://ccb.jhu.edu/software/hisat2/index.shtml">Hisat2</a>、STAR、Tophat（前几年比较常用，现在被前两个替代了）</li>
<li>比对完成之后的输出文件是SAM文件，这是一种序列比对格式标准，是以TAB为分割符的文本格式，用于储存测序序列mapping到基因组上的结果，当然也可以表示任意的多重比对结果</li>
</ul>
<h2 id="SAM文件内容"><a href="#SAM文件内容" class="headerlink" title="SAM文件内容"></a>SAM文件内容</h2><ul>
<li>注释信息和比对结果两部份组成</li>
<li>注释信息可有可无，都是以”@”开头的</li>
<li>比对结果部份表示一个片段的比对信息，一共包括11个必须字段和1个可选字段，字段之间使用tab进行分割</li>
</ul>
<h2 id="SAM对比示例"><a href="#SAM对比示例" class="headerlink" title="SAM对比示例"></a>SAM对比示例</h2><p><img src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E6%88%AA%E5%B1%8F2024-04-21%2010.51.41.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<ul>
<li>第一列：对比片段的ID</li>
<li>第二列：比对情况（第一行的163，这里每一个数字代表一种比对情况，这里的值是符合情况的数字相加的总和</li>
<li>第三列：对比到参考序列上的染色体号，如果没有对比上，这一列以” * “替代</li>
<li>第四列：read比对到的参考序列上的，第一个碱基所在的位置，如果没有比对上，这个值是0</li>
<li>第五列：对比的质量分数，这个值越高，说明这个read比对到参考基因组上的位置越唯一，如果是0，说明没有比对上，或者比对到了重复序列</li>
<li>第六列：简要的比对信息表达式，是以参考序列为基础，使用数字+字母表示比对的结果<ul>
<li>图中示例的150M：这条read的150个碱基全部比对上</li>
<li>图中示例的3S6M1P1I4M<ul>
<li>3S：前三个碱基被剪切去除了</li>
<li>6M：6个碱基比对上了</li>
<li>1P：打开了一个缺口</li>
<li>1I：有1个碱基插入</li>
<li>4M：最后4个碱基比对上了</li>
</ul>
</li>
</ul>
</li>
<li>第七列：read2比对上的参考序列的编号，这是针对双端测序而言的，单端测序这里是” * “</li>
<li>第八列：read2比对到的参考序列上的，第一个碱基所在的位置，如果没有比对上，这个值是0</li>
<li>第九列：片段的长度</li>
<li>第十列：序列片段的序列信息，即测序的read的序列信息，格式同FASTQ</li>
<li>第十一列：序列的质量信息</li>
<li>得到SAM文件后，我们通常会把它转换为BAM文件，BAM是SAM的二进制文件，储存的信息是一样的，但是占用的储存空间更加小</li>
</ul>
<h1 id="基因表达水平定量"><a href="#基因表达水平定量" class="headerlink" title="基因表达水平定量"></a>基因表达水平定量</h1><ul>
<li>一般使用HTSeq，本质是一个python库，具有多种功能，但我们只用其中的htseq-count来进行基因定量</li>
<li>htseq-count的功能：根据基因结构注释文件（.gtf），对排序过的BAM文件进行基因reads数的统计，最终得到counts计数文件<br><img src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E6%88%AA%E5%B1%8F2024-04-21%2013.58.33.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></li>
<li>上图中展示的是一个整理过的 counts 文件，列是样本，行是基因名，数字代表这个样本中比对到每一个基因的reads的计数。</li>
<li>如果是单端测序，那么一个read比对到基因 A上，计数就为 1，如果是双端测序，一对 reads比对到基因A 上，计数也为1</li>
<li>一个样本会得到一个counts文件，这里展示的是将多个样本整理到一个文件中的counts。counts是比对到基因上reads 的绝对计数也是下一步进行差异分析的输入文件。</li>
</ul>
<h1 id="差异基因分析"><a href="#差异基因分析" class="headerlink" title="差异基因分析"></a>差异基因分析</h1><h2 id="差异分析常用工具"><a href="#差异分析常用工具" class="headerlink" title="差异分析常用工具"></a>差异分析常用工具</h2><ul>
<li>DESeq2</li>
<li>edgeR</li>
<li>limma</li>
</ul>
<h2 id="差异分析流程图"><a href="#差异分析流程图" class="headerlink" title="差异分析流程图"></a>差异分析流程图</h2><p>  <img src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E6%88%AA%E5%B1%8F2024-04-21%2014.05.45.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<ul>
<li>多重假设检验校正：Bonferroni校正法较严格，FDR校正法较温和</li>
<li>常用的筛选条件<ul>
<li>p value&lt;0.05</li>
<li>adjusted p value&lt;0.05是更加严格的做法</li>
<li>Fold Change≥2</li>
</ul>
</li>
</ul>
<h1 id="扩展：其他的定量数据"><a href="#扩展：其他的定量数据" class="headerlink" title="扩展：其他的定量数据"></a>扩展：其他的定量数据</h1><h2 id="定量数据的类型"><a href="#定量数据的类型" class="headerlink" title="定量数据的类型"></a>定量数据的类型</h2><ul>
<li>Counts：对比到参考基因组上的Reads（Fragments）的原始计数</li>
<li>RPKM&#x2F;FPKM：每百万个reads&#x2F;fragments中来自某基因每千碱基长度的reads数，即将比对到基因的read数除以比对到基因组上的所有 read 数与基因的长度<br><img src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E6%88%AA%E5%B1%8F2024-04-21%2014.19.54.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></li>
<li>Reads与Fragments的关系：reads是指下机后fastq数据中的每一条 reads，fragments呢是指每一段用于测序的核酸片段，在单端测序中，一个fragments只测一条reads，reads数与fragments数目相等；在双端测序中，一个fragments测两端，会得到2条reads，这2个reads只能算一个fragments，所以fragments的值是reads的1或2倍 </li>
<li>TPM：消除了exon长度造成的差异<br><img src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E6%88%AA%E5%B1%8F2024-04-21%2014.25.47.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></li>
<li>RPM&#x2F;CPM：比对到某一个基因的read&#x2F;count数除以基因组上总的read&#x2F;count数，有助于样本之间进行比较<br><img src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E6%88%AA%E5%B1%8F2024-04-21%2014.27.17.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></li>
</ul>

</article>
    
    

</div>
<div class="trm-post-next-prev row">
    <div class="col-lg-12">
        <!-- title -->
        <h5 class="trm-title-with-divider">
            Other Articles
            <span data-number="02"></span>
        </h5>
    </div>
    
        <div class="col-lg-6">
    <div class="trm-older-publications-card trm-scroll-animation trm-active-el">
        <div class="trm-older-publication">
            
            <a class="trm-op-top trm-anima-link" href="/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6%20Lesson%209%20%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">
                <span class="trm-op-cover">
                    <img alt="cover" class="no-fancybox" src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/cover.jpg">
                </span>
                <h6 class="trm-op-title">生信全书 Lesson 9 富集分析基础知识</h6>
            </a>
            <div class="trm-divider trm-mb-15 trm-mt-20"></div>
            <ul class="trm-card-data trm-label">
                <li>24/10/24</li>
                <li>13:07</li>
                <li>科研</li>
            </ul>
        </div>
    </div>
</div>
    
    
        <div class="col-lg-6">
    <div class="trm-older-publications-card trm-scroll-animation trm-active-el">
        <div class="trm-older-publication">
            
            <a class="trm-op-top trm-anima-link" href="/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6%20Lesson%208.3%20%E5%9F%BA%E5%9B%A0ID%E8%BD%AC%E6%8D%A2%E5%B7%A5%E5%85%B7/">
                <span class="trm-op-cover">
                    <img alt="cover" class="no-fancybox" src="/img/%E8%A7%A3%E8%9E%BA%E6%97%8B%C2%B7%E7%94%9F%E4%BF%A1%E5%85%A8%E4%B9%A6/cover.jpg">
                </span>
                <h6 class="trm-op-title">生信全书 Lesson 8.3 基因ID转换工具</h6>
            </a>
            <div class="trm-divider trm-mb-15 trm-mt-20"></div>
            <ul class="trm-card-data trm-label">
                <li>24/10/24</li>
                <li>13:07</li>
                <li>科研</li>
            </ul>
        </div>
    </div>
</div>
    
</div>

    



                    <div class="trm-divider footer-divider"></div>

                    <!-- footer -->
                    <footer class="trm-scroll-animation">

    

    

    
        <div class="trm-footer-item">
            <span>
                Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v7.1.1
            </span>
            <span class="footer-separator" data-separator=" | "></span>
            <span> 
                Theme - 
                <a rel="noopener" href='https://github.com/MaLuns/hexo-theme-async' target='_blank'>Async</a>
                v2.1.13
            </span>
        </div>
      

    
        <div class="trm-footer-item blog-run-long"></div>
     

     
</footer>
                    <!-- footer end -->

                </div>
            </div>
        </div>
    </div>
</div>
            <!-- body end -->

            

    <div id="post-toc" class="trm-post-toc">
      <div class="trm-post-toc-header">
        Article table of contents
				<span id="post-toc-top">
					TOP
				</span>
      </div>
      <div class="trm-post-toc-content">
        <ol class="trm-toc"><li class="trm-toc-item trm-toc-level-1" title="原机下载数据"><a rel="nofollow" class="trm-toc-link" href="#原机下载数据"><span class="trm-toc-number">1.</span> <span class="trm-toc-text">原机下载数据</span></a><ol class="trm-toc-child"><li class="trm-toc-item trm-toc-level-2" title="单端测序和双端测序的比较"><a rel="nofollow" class="trm-toc-link" href="#单端测序和双端测序的比较"><span class="trm-toc-number">1.1.</span> <span class="trm-toc-text">单端测序和双端测序的比较</span></a></li></ol></li><li class="trm-toc-item trm-toc-level-1" title="测序质量评估和质控处理"><a rel="nofollow" class="trm-toc-link" href="#测序质量评估和质控处理"><span class="trm-toc-number">2.</span> <span class="trm-toc-text">测序质量评估和质控处理</span></a><ol class="trm-toc-child"><li class="trm-toc-item trm-toc-level-2" title="质量评估：FastQC"><a rel="nofollow" class="trm-toc-link" href="#质量评估：FastQC"><span class="trm-toc-number">2.1.</span> <span class="trm-toc-text">质量评估：FastQC</span></a><ol class="trm-toc-child"><li class="trm-toc-item trm-toc-level-3" title="碱基质量评估的结果"><a rel="nofollow" class="trm-toc-link" href="#碱基质量评估的结果"><span class="trm-toc-number">2.1.1.</span> <span class="trm-toc-text">碱基质量评估的结果</span></a></li></ol></li><li class="trm-toc-item trm-toc-level-2" title="质控处理"><a rel="nofollow" class="trm-toc-link" href="#质控处理"><span class="trm-toc-number">2.2.</span> <span class="trm-toc-text">质控处理</span></a><ol class="trm-toc-child"><li class="trm-toc-item trm-toc-level-3" title="质控处理的目的"><a rel="nofollow" class="trm-toc-link" href="#质控处理的目的"><span class="trm-toc-number">2.2.1.</span> <span class="trm-toc-text">质控处理的目的</span></a></li></ol></li></ol></li><li class="trm-toc-item trm-toc-level-1" title="基因组比对"><a rel="nofollow" class="trm-toc-link" href="#基因组比对"><span class="trm-toc-number">3.</span> <span class="trm-toc-text">基因组比对</span></a><ol class="trm-toc-child"><li class="trm-toc-item trm-toc-level-2" title="SAM文件内容"><a rel="nofollow" class="trm-toc-link" href="#SAM文件内容"><span class="trm-toc-number">3.1.</span> <span class="trm-toc-text">SAM文件内容</span></a></li><li class="trm-toc-item trm-toc-level-2" title="SAM对比示例"><a rel="nofollow" class="trm-toc-link" href="#SAM对比示例"><span class="trm-toc-number">3.2.</span> <span class="trm-toc-text">SAM对比示例</span></a></li></ol></li><li class="trm-toc-item trm-toc-level-1" title="基因表达水平定量"><a rel="nofollow" class="trm-toc-link" href="#基因表达水平定量"><span class="trm-toc-number">4.</span> <span class="trm-toc-text">基因表达水平定量</span></a></li><li class="trm-toc-item trm-toc-level-1" title="差异基因分析"><a rel="nofollow" class="trm-toc-link" href="#差异基因分析"><span class="trm-toc-number">5.</span> <span class="trm-toc-text">差异基因分析</span></a><ol class="trm-toc-child"><li class="trm-toc-item trm-toc-level-2" title="差异分析常用工具"><a rel="nofollow" class="trm-toc-link" href="#差异分析常用工具"><span class="trm-toc-number">5.1.</span> <span class="trm-toc-text">差异分析常用工具</span></a></li><li class="trm-toc-item trm-toc-level-2" title="差异分析流程图"><a rel="nofollow" class="trm-toc-link" href="#差异分析流程图"><span class="trm-toc-number">5.2.</span> <span class="trm-toc-text">差异分析流程图</span></a></li></ol></li><li class="trm-toc-item trm-toc-level-1" title="扩展：其他的定量数据"><a rel="nofollow" class="trm-toc-link" href="#扩展：其他的定量数据"><span class="trm-toc-number">6.</span> <span class="trm-toc-text">扩展：其他的定量数据</span></a><ol class="trm-toc-child"><li class="trm-toc-item trm-toc-level-2" title="定量数据的类型"><a rel="nofollow" class="trm-toc-link" href="#定量数据的类型"><span class="trm-toc-number">6.1.</span> <span class="trm-toc-text">定量数据的类型</span></a></li></ol></li></ol>
      </div>
    </div>

            
<div class="trm-fixed-container">
    
        <div class="trm-fixed-btn post-toc-btn" data-title="Open toc">
            <i class="iconfont fas fa-th-list"></i>
        </div>
    
    
        <div class="trm-fixed-btn" data-title="Read Mode" onclick="asyncFun.switchReadMode()">
            <i class="iconfont fas fa-book-reader"></i>
        </div>
    
    
        <div class="trm-fixed-btn hidden-md" data-title="Toggle between single-column and double-column" onclick="asyncFun.switchSingleColumn()">
            <i class="iconfont fas fa-arrows-alt-h"></i>
        </div>
    
    <div id="trm-back-top" class="trm-fixed-btn" data-title="Back To Top">
        <i class="iconfont fas fa-arrow-up"></i>
    </div>
</div>
        </div>
      </div>
      <!-- scroll container end -->
  </div>
  <!-- app wrapper end -->

  
    <div class="trm-search-popup">
        <div class="trm-search-wrapper">
            <div class="form trm-search-form">
                <div class="trm-search-input-icon">
                    <i class="iconfont fas fa-search"></i>
                </div>
                <input class="trm-search-input" type="text" placeholder="Searching...">
                <div class="trm-search-btn-close">
                    <i class="iconfont fas fa-times"></i>
                </div>
            </div>
            <div class="trm-search-result-container">
                <div class="trm-search-empty">
                    Find Something Special?
                </div>
            </div>
            <div class="trm-search-footer">
                <div class="trm-search-stats"></div>
                <ul class="trm-search-commands">
                    <li>
                        <kbd class="command-palette-commands-key">
                            <svg width="15" height="15" aria-label="Escape key" role="img">
                                <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                    stroke-width="1.2">
                                    <path
                                        d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993 0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016.8634 0 1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5c.032.5663-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864 0 1.6425 1.031 1.5443 2.2492h-2.956">
                                    </path>
                                </g>
                            </svg>
                        </kbd>
                        <span class="command-palette-Label">to close</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>

  <!-- Plugin -->




    
    
<script src="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>

    

    

    
        
<script src="https://unpkg.com/hexo-generator-searchdb@1.4.0/dist/search.js"></script>

        <script src="/js/plugins/local_search.js?v=2.1.13"></script>
    

    <!-- 数学公式 -->
    

    <!-- 评论插件 -->
    
        

        
    

		




    <!-- Service Worker -->
    
    <script>
        "serviceWorker" in navigator ?
        navigator.serviceWorker.register('/sw.js').then(function () {
            navigator.serviceWorker.controller ? 
             console.log("Assets cached by the controlling service worker.") :
             console.log("Please reload this page to allow the service worker to handle network operations.")
        }).catch(function (e) {
            console.log("ERROR: " + e)
        }) : console.log("Service workers are not supported in the current browser.")
    </script>

    <!-- baidu push -->
    


<script id="async-script" src="/js/main.js?v=2.1.13"></script>

<!-- CDN -->


    

    

    



</body>

</html>